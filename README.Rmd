---
title: "fastbackward"
output: github_document
---

# Overview

**fastbackward** is a package with only the `fastbackward()` function, which is 
essentially the same as using backward elimination with the `step()` function from 
the **stats** package. Except the `fastbackward()` function makes use of a bounding 
algorithm to perform backward elimination faster.

# How to install

It can be installed via the `install_github()` function from the 
**devtools** package.

```{r, eval = FALSE}
devtools::install_github("JacobSeedorff21/fastbackward")

```

# Usage

Here is a comparison of runtimes with the `step()` function from the 
**stats** package and the `fastbackward()` function from the **fastbackward** 
package. This comparison is based upon a randomly generated logistic 
regression model with 1000 observations and 50 covariates. 

```{r, warning = FALSE, message = FALSE}
# Loading in fastbackward
library(fastbackward)

# Defining function to generate datasets for logistic regression
LogisticSimul <- function(n, d, Bprob = .5, sd = 1, rho = 0.5){
  
  x <- MASS::mvrnorm(n, mu = rep(1, d), Sigma = diag(1 - rho, nrow = d, ncol = d) + 
                 matrix(rho, ncol = d, nrow = d))
  
  beta <- rnorm(d + 1, mean = 0, sd = sd) 
  
  beta[sample(2:length(beta), floor((length(beta) - 1) * Bprob))] = 0
  beta[beta != 0] <- beta[beta != 0] - mean(beta[beta != 0])
  
  p <- 1/(1 + exp(-x %*% beta[-1] - beta[1]))
  
  y <- rbinom(n, 1, p)
  
  df <- cbind(y, x) |> 
    as.data.frame()
  df
}

# Setting seed and creating dataset
set.seed(33391)
df <- LogisticSimul(1000, 50, .5, sd = 0.5)

# Fitting full logistic regression model
fullmodel <- glm(y ~ ., data = df, family = binomial(link = "logit"))

# Times
## Timing fast backward elimination
fastbackwardTime <- system.time(fastbackward1 <- fastbackward(fullmodel, trace = 0))
fastbackwardTime

## Timing step function
stepTime <- system.time(BackwardStep <- step(fullmodel, direction = "backward", trace = 0))
stepTime

```

Using the fast backward elimination algorithm from the **fastbackward** package was 
about `r round(stepTime[[3]] / fastbackwardTime[[3]], 2)` times faster than step was 
for this logistic regression model. The amount of speedup attained by using the 
fast backward algorithm depends on the strength of association between the 
covariates and the response variable, so it will vary depending on the specific 
problem.

### Checking results

```{r}
# Checking if both methods give same results
all.equal(BackwardStep, fastbackward1)

```

Hence the two methods give the same results and the fast backward elimination 
algorithm is faster than step.

